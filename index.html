<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gyro Dot Test</title>
<style>
html, body { margin:0; padding:0; height:100%; width:100%; display:flex; justify-content:center; align-items:center; background:#f7f7f9; }
#arena { position:relative; width:100%; height:100%; background:#eee; }
#dot { position:absolute; width:36px; height:36px; border-radius:50%; background:#0575e6; transform:translate(-50%,-50%); top:50%; left:50%; }
#btn { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); padding:12px 18px; font-size:16px; z-index:10; }
</style>
</head>
<body>
<div id="arena">
  <div id="dot"></div>
  <button id="btn">Enable Gyro</button>
</div>

<script>
const dot = document.getElementById('dot');
const btn = document.getElementById('btn');
const arena = document.getElementById('arena');

let arenaRect = arena.getBoundingClientRect();
let dotPos = { x: arenaRect.width/2, y: arenaRect.height/2 };

function updateDot() {
  dot.style.left = dotPos.x + 'px';
  dot.style.top = dotPos.y + 'px';
  requestAnimationFrame(updateDot);
}
updateDot();

function handleOrientation(e) {
  const gamma = e.gamma || 0; // left-right
  const beta = e.beta || 0;   // front-back
  dotPos.x += gamma * 0.5;
  dotPos.y += beta * 0.5;
  dotPos.x = Math.max(18, Math.min(arenaRect.width-18, dotPos.x));
  dotPos.y = Math.max(18, Math.min(arenaRect.height-18, dotPos.y));
}

async function enableGyro() {
  if(typeof DeviceOrientationEvent !== 'undefined' &&
     typeof DeviceOrientationEvent.requestPermission === 'function'){
    try {
      const res = await DeviceOrientationEvent.requestPermission();
      if(res==='granted'){
        window.addEventListener('deviceorientation', handleOrientation);
        btn.style.display='none';
      } else {
        alert('Permission denied');
      }
    } catch(err) {
      alert('Error requesting permission');
    }
  } else {
    window.addEventListener('deviceorientation', handleOrientation);
    btn.style.display='none';
  }
}

btn.addEventListener('click', enableGyro);

window.addEventListener('resize', () => { arenaRect = arena.getBoundingClientRect(); });
</script>
</body>
</html>
